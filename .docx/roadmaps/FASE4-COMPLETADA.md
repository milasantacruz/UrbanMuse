# âœ… Fase 4: Domain Layer - Repositorios (Interfaces) - COMPLETADA

**Fecha de finalizaciÃ³n:** 12 de Diciembre, 2025  
**Tiempo estimado:** 3-4 horas  
**Tiempo real:** ~2 horas

---

## ğŸ“‹ Tareas Completadas

### âœ… T4.1: ObraRepository Interface
- [x] `lib/domain/repositories/obra_repository.dart` ya existÃ­a y estÃ¡ completo:
  - [x] getObras() âœ…
  - [x] getObraById() âœ…
  - [x] searchObras() âœ…
  - [x] filterObras() âœ…
  - [x] Retornan Future<Either<Failure, T>> âœ…

### âœ… T4.2: ArtistaRepository Interface
- [x] `lib/domain/repositories/artista_repository.dart` ya existÃ­a y estÃ¡ completo:
  - [x] getArtistaById() âœ…
  - [x] getObrasByArtista() âœ…
  - [x] Retornan Future<Either<Failure, T>> âœ…

### âœ… T4.3: RutaRepository Interface
- [x] `lib/domain/repositories/ruta_repository.dart` actualizado:
  - [x] createRuta() âœ…
  - [x] getRutas() âœ…
  - [x] **NUEVO:** getRutasPublicas() âœ…
  - [x] **NUEVO:** getRutasPublicasDinamicas() âœ…
  - [x] getRutaById() âœ…
  - [x] deleteRuta() âœ…
  - [x] calculateRuta() (actualizado con modoTransporte) âœ…
  - [x] **NUEVO:** convertirADinamica() âœ…
  - [x] **NUEVO:** joinRutaDinamica() âœ…
  - [x] **NUEVO:** leaveRutaDinamica() âœ…
  - [x] Retornan Future<Either<Failure, T>> âœ…

### âœ… T4.4: TopNRepository Interface
- [x] **NUEVO:** `lib/domain/repositories/topn_repository.dart` creado:
  - [x] getTopN() - Obtener Top N de rutas (mÃ¡ximo 10) âœ…
  - [x] addRutaToTopN() - Agregar ruta al Top N âœ…
  - [x] removeRutaFromTopN() - Remover ruta del Top N âœ…
  - [x] reorderTopN() - Reordenar Top N âœ…
  - [x] Retornan Future<Either<Failure, List<Ruta>>> âœ…
  - [x] **Nota:** Reemplaza Top10Repository que manejaba obras. Ahora maneja rutas.

### âœ… T4.5: EncuentroRepository Interface
- [x] **NUEVO:** `lib/domain/repositories/encuentro_repository.dart` creado:
  - [x] createEncuentro() - Solo artistas âœ…
  - [x] getEncuentros() âœ…
  - [x] getEncuentrosProximos() âœ…
  - [x] getEncuentroById() âœ…
  - [x] joinEncuentro() âœ…
  - [x] cancelEncuentro() - Solo el creador âœ…
  - [x] getEncuentrosByArtista() âœ…
  - [x] Retornan Future<Either<Failure, T>> âœ…
  - [x] **Nota:** Reemplaza SalidaRepository. Solo artistas pueden crear encuentros.

### âœ… T4.6: PublicarObraRepository Interface
- [x] **NUEVO:** `lib/domain/repositories/publicar_obra_repository.dart` creado:
  - [x] publicarObra() - Solo artistas, valida CABA âœ…
  - [x] getObrasPublicadasPorArtista() âœ…
  - [x] editarObra() - Solo el creador âœ…
  - [x] eliminarObra() - Solo el creador âœ…
  - [x] puedeEliminarObra() - Verificar permisos âœ…
  - [x] Retornan Future<Either<Failure, T>> âœ…
  - [x] **Nota:** Solo artistas pueden publicar obras.

### âœ… T4.7: UsuarioRepository Interface
- [x] **NUEVO:** `lib/domain/repositories/usuario_repository.dart` creado:
  - [x] getUsuarioById() âœ…
  - [x] getUsuarioActual() âœ…
  - [x] registrarUsuario() - Con tipoUsuario (visitante/artista) âœ…
  - [x] updateUsuario() âœ…
  - [x] esArtista() âœ…
  - [x] esVisitante() âœ…
  - [x] Retornan Future<Either<Failure, T>> âœ…

---

## ğŸ”§ Cambios Importantes

### Repositorios Renombrados/Creados:
- **Top10Repository** â†’ **TopNRepository** (ahora maneja rutas, no obras)
- **SalidaRepository** â†’ **EncuentroRepository** (nuevo concepto)
- **PublicarObraRepository** (nuevo, solo artistas)
- **UsuarioRepository** (nuevo)

### Nuevos MÃ©todos en RutaRepository:
- `getRutasPublicas()` - Obtener rutas pÃºblicas estÃ¡ticas
- `getRutasPublicasDinamicas()` - Obtener rutas pÃºblicas dinÃ¡micas
- `convertirADinamica()` - Convertir ruta estÃ¡tica a dinÃ¡mica
- `joinRutaDinamica()` - Unirse a ruta dinÃ¡mica
- `leaveRutaDinamica()` - Salir de ruta dinÃ¡mica

### Validaciones y Permisos:
- Solo artistas pueden crear encuentros
- Solo artistas pueden publicar obras
- Solo el creador puede editar/eliminar obras
- Solo el creador puede cancelar encuentros
- ValidaciÃ³n de ubicaciÃ³n en CABA para publicar obras

---

## ğŸ“Š Estado del Proyecto

### âœ… Repositorios Implementados:
- âœ… ObraRepository (verificado)
- âœ… ArtistaRepository (verificado)
- âœ… RutaRepository (actualizado)
- âœ… TopNRepository (nuevo)
- âœ… EncuentroRepository (nuevo)
- âœ… PublicarObraRepository (nuevo)
- âœ… UsuarioRepository (nuevo)

### ğŸ“ Archivos Creados/Modificados:
- `lib/domain/repositories/obra_repository.dart` - Verificado
- `lib/domain/repositories/artista_repository.dart` - Verificado
- `lib/domain/repositories/ruta_repository.dart` - Actualizado
- `lib/domain/repositories/topn_repository.dart` - **NUEVO**
- `lib/domain/repositories/encuentro_repository.dart` - **NUEVO**
- `lib/domain/repositories/publicar_obra_repository.dart` - **NUEVO**
- `lib/domain/repositories/usuario_repository.dart` - **NUEVO**

### âš ï¸ Notas:
- `top10_repository.dart` y `salida_repository.dart` aÃºn existen pero serÃ¡n reemplazados en futuras fases
- Todas las interfaces usan `Either<Failure, T>` para manejo funcional de errores
- Todas las interfaces estÃ¡n listas para implementaciÃ³n en Data Layer

---

## ğŸ¯ PrÃ³ximos Pasos

**Fase 5: Domain Layer - Use Cases**
- T5.1: Use Cases de Obra
- T5.2: Use Cases de Artista
- T5.3: Use Cases de Ruta (con soporte para rutas dinÃ¡micas)
- T5.4: Use Cases de Top N (reemplaza Top 10)
- T5.5: Use Cases de Encuentro (reemplaza Salida)
- T5.6: Use Cases de Publicar Obra
- T5.7: Use Cases de Usuario

---

*Fase completada exitosamente* âœ…

